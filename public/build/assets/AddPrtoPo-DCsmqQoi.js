import{r as i,j as e}from"./app-_4GNH0o8.js";import{B as w}from"./button-C48SFmXx.js";import{c as ve,a as v,P as E,D as De,b as Ce,u as be,d as Re,X as we}from"./x-DWI_0bja.js";import{u as I,S as Pe,c as j,f as z}from"./utils-DtDAP0nT.js";import{u as P}from"./index-Cp2SHByU.js";import{R as Ee,h as Ie,u as Oe,F as Me}from"./Combination-CZsHR2mP.js";import{P as D}from"./index-BjmvShgX.js";import{L as _,I as y}from"./input-BQisfHEL.js";var O="Dialog",[V,tt]=ve(O),[Ae,x]=V(O),U=t=>{const{__scopeDialog:a,children:s,open:r,defaultOpen:n,onOpenChange:o,modal:u=!0}=t,p=i.useRef(null),m=i.useRef(null),[c=!1,N]=be({prop:r,defaultProp:n,onChange:o});return e.jsx(Ae,{scope:a,triggerRef:p,contentRef:m,contentId:P(),titleId:P(),descriptionId:P(),open:c,onOpenChange:N,onOpenToggle:i.useCallback(()=>N(R=>!R),[N]),modal:u,children:s})};U.displayName=O;var K="DialogTrigger",Q=i.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=x(K,s),o=I(a,n.triggerRef);return e.jsx(D.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":T(n.open),...r,ref:o,onClick:v(t.onClick,n.onOpenToggle)})});Q.displayName=K;var M="DialogPortal",[Te,X]=V(M,{forceMount:void 0}),Y=t=>{const{__scopeDialog:a,forceMount:s,children:r,container:n}=t,o=x(M,a);return e.jsx(Te,{scope:a,forceMount:s,children:i.Children.map(r,u=>e.jsx(E,{present:s||o.open,children:e.jsx(Re,{asChild:!0,container:n,children:u})}))})};Y.displayName=M;var b="DialogOverlay",Z=i.forwardRef((t,a)=>{const s=X(b,t.__scopeDialog),{forceMount:r=s.forceMount,...n}=t,o=x(b,t.__scopeDialog);return o.modal?e.jsx(E,{present:r||o.open,children:e.jsx(Se,{...n,ref:a})}):null});Z.displayName=b;var Se=i.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=x(b,s);return e.jsx(Ee,{as:Pe,allowPinchZoom:!0,shards:[n.contentRef],children:e.jsx(D.div,{"data-state":T(n.open),...r,ref:a,style:{pointerEvents:"auto",...r.style}})})}),f="DialogContent",J=i.forwardRef((t,a)=>{const s=X(f,t.__scopeDialog),{forceMount:r=s.forceMount,...n}=t,o=x(f,t.__scopeDialog);return e.jsx(E,{present:r||o.open,children:o.modal?e.jsx(Le,{...n,ref:a}):e.jsx(Fe,{...n,ref:a})})});J.displayName=f;var Le=i.forwardRef((t,a)=>{const s=x(f,t.__scopeDialog),r=i.useRef(null),n=I(a,s.contentRef,r);return i.useEffect(()=>{const o=r.current;if(o)return Ie(o)},[]),e.jsx(ee,{...t,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:v(t.onCloseAutoFocus,o=>{var u;o.preventDefault(),(u=s.triggerRef.current)==null||u.focus()}),onPointerDownOutside:v(t.onPointerDownOutside,o=>{const u=o.detail.originalEvent,p=u.button===0&&u.ctrlKey===!0;(u.button===2||p)&&o.preventDefault()}),onFocusOutside:v(t.onFocusOutside,o=>o.preventDefault())})}),Fe=i.forwardRef((t,a)=>{const s=x(f,t.__scopeDialog),r=i.useRef(!1),n=i.useRef(!1);return e.jsx(ee,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var u,p;(u=t.onCloseAutoFocus)==null||u.call(t,o),o.defaultPrevented||(r.current||(p=s.triggerRef.current)==null||p.focus(),o.preventDefault()),r.current=!1,n.current=!1},onInteractOutside:o=>{var m,c;(m=t.onInteractOutside)==null||m.call(t,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const u=o.target;((c=s.triggerRef.current)==null?void 0:c.contains(u))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&n.current&&o.preventDefault()}})}),ee=i.forwardRef((t,a)=>{const{__scopeDialog:s,trapFocus:r,onOpenAutoFocus:n,onCloseAutoFocus:o,...u}=t,p=x(f,s),m=i.useRef(null),c=I(a,m);return Oe(),e.jsxs(e.Fragment,{children:[e.jsx(Me,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:n,onUnmountAutoFocus:o,children:e.jsx(De,{role:"dialog",id:p.contentId,"aria-describedby":p.descriptionId,"aria-labelledby":p.titleId,"data-state":T(p.open),...u,ref:c,onDismiss:()=>p.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(ke,{titleId:p.titleId}),e.jsx(qe,{contentRef:m,descriptionId:p.descriptionId})]})]})}),A="DialogTitle",te=i.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=x(A,s);return e.jsx(D.h2,{id:n.titleId,...r,ref:a})});te.displayName=A;var ae="DialogDescription",oe=i.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=x(ae,s);return e.jsx(D.p,{id:n.descriptionId,...r,ref:a})});oe.displayName=ae;var se="DialogClose",re=i.forwardRef((t,a)=>{const{__scopeDialog:s,...r}=t,n=x(se,s);return e.jsx(D.button,{type:"button",...r,ref:a,onClick:v(t.onClick,()=>n.onOpenChange(!1))})});re.displayName=se;function T(t){return t?"open":"closed"}var ne="DialogTitleWarning",[at,le]=Ce(ne,{contentName:f,titleName:A,docsSlug:"dialog"}),ke=({titleId:t})=>{const a=le(ne),s=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return i.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},$e="DialogDescriptionWarning",qe=({contentRef:t,descriptionId:a})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${le($e).contentName}}.`;return i.useEffect(()=>{var o;const n=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");a&&n&&(document.getElementById(a)||console.warn(r))},[r,t,a]),null},Ge=U,We=Q,Be=Y,ie=Z,ce=J,de=te,ue=oe,pe=re;const ze=Ge,He=We,Ve=Be,H=pe,xe=i.forwardRef(({className:t,...a},s)=>e.jsx(ie,{ref:s,className:j("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));xe.displayName=ie.displayName;const me=i.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(Ve,{children:[e.jsx(xe,{}),e.jsxs(ce,{ref:r,className:j("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[a,e.jsxs(pe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));me.displayName=ce.displayName;const ge=({className:t,...a})=>e.jsx("div",{className:j("flex flex-col space-y-1.5 text-center sm:text-left",t),...a});ge.displayName="DialogHeader";const fe=({className:t,...a})=>e.jsx("div",{className:j("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});fe.displayName="DialogFooter";const he=i.forwardRef(({className:t,...a},s)=>e.jsx(de,{ref:s,className:j("text-lg font-semibold leading-none tracking-tight",t),...a}));he.displayName=de.displayName;const _e=i.forwardRef(({className:t,...a},s)=>e.jsx(ue,{ref:s,className:j("text-sm text-muted-foreground",t),...a}));_e.displayName=ue.displayName;function ot({p_vendor:t,p_plant:a,p_created_name:s,p_doc_date:r,addToPO:n}){const[o,u]=i.useState([]),[p,m]=i.useState([]),[c,N]=i.useState({pr_number:"",material:"",mat_grp:"",purch_grp:"",short_text:"",del_date:""}),R=async()=>{try{const l=await window.axios.get(route("po.plant"),{params:{plant:a,vendor:t,doc_date:r}});m(l.data.data)}catch(l){console.error("Error fetching material info:",l)}},ye=(l,d)=>{l.target.checked?u([...o,d]):u(o.filter(g=>g.id!==d.id))},je=()=>{const l=o.map(d=>{let g,L=d.unit,F=d.per_unit,k=d.qty_open,$,q,G,W=1,B=1;if(d.material_net_price[0]){const C=d.alt_uom.find(Ne=>Ne.alt_uom==d.material_net_price[0].uom);g=d.qty_open/(C.counter/C.denominator),k=g,W=C.counter,B=C.denominator,L=d.material_net_price[0].uom,F=d.material_net_price[0].per_unit,$=d.material_net_price[0].price,q=d.material_net_price[0].price/d.material_net_price[0].per_unit*g,G=d.material_net_price[0].min_order_qty}return{...d,del_date:new Date(d.del_date||""),pr_material_id:d.id,pr_item:d.item_no,qty_open:k,unit:L,per_unit:F,net_price:$,total_value:q,item_no:void 0,id:void 0,min_order_qty:G,conversion:W,denominator:B,converted_qty:d.qty_open,pr_unit:d.unit,purch_grp:d.purch_grp}});n(l),u([])},h=l=>{const{id:d,value:g}=l.target;N({...c,[d]:g})},S=p.filter(l=>(c.pr_number===""||(l.pr_number||"").toLowerCase().includes(c.pr_number.toLowerCase()))&&(c.material===""||(l.mat_code||"").toLowerCase().includes(c.material.toLowerCase()))&&(c.mat_grp===""||(l.mat_grp||"").toLowerCase().includes(c.mat_grp.toLowerCase()))&&(c.purch_grp===""||(l.purch_grp||"").toLowerCase().includes(c.purch_grp.toLowerCase()))&&(c.short_text===""||(l.short_text||"").toLowerCase().includes(c.short_text.toLowerCase()))&&(c.del_date===""||(l.del_date||"").toLowerCase().includes(c.del_date.toLowerCase())));return e.jsxs(ze,{children:[e.jsx(He,{children:e.jsx(w,{type:"button",variant:"outline",className:"bg-blue-400 hover:bg-blue-500 hover:text-accent-foreground hover:border-gray-500",onClick:R,children:"Add PR to PO"})}),e.jsxs(me,{className:"min-w-full sm:max-w-md",children:[e.jsx(ge,{children:e.jsx(he,{children:"PR Selection"})}),e.jsxs(_e,{children:[e.jsx("div",{className:"flex items-center space-x-2 w-full",children:e.jsxs("div",{className:"p-2 flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex-auto",children:[e.jsx(_,{children:"PR Number"}),e.jsx(y,{type:"text",id:"pr_number",value:c.pr_number,onChange:h})]}),e.jsxs("div",{className:"flex-auto",children:[e.jsx(_,{children:"Material"}),e.jsx(y,{type:"text",id:"material",value:c.material,onChange:h})]}),e.jsxs("div",{className:"flex-auto",children:[e.jsx(_,{children:"Short Text"}),e.jsx(y,{type:"text",id:"short_text",value:c.short_text,onChange:h})]}),e.jsxs("div",{className:"flex-auto",children:[e.jsx(_,{children:"Delivery Date"}),e.jsx(y,{type:"text",id:"del_date",value:c.del_date,onChange:h})]}),e.jsxs("div",{className:"flex-auto",children:[e.jsx(_,{children:"Material Group"}),e.jsx(y,{type:"text",id:"mat_grp",value:c.mat_grp,onChange:h})]}),e.jsxs("div",{className:"flex-auto",children:[e.jsx(_,{children:"Buyer Group"}),e.jsx(y,{type:"text",id:"purch_grp",value:c.purch_grp,onChange:h})]})]})}),e.jsx("div",{className:"overflow-y-auto h-96",children:e.jsxs("table",{className:" table-auto w-full text-sm text-left rtl:text-right text-gray-500 ",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50  border-gray-500 sticky top-0",children:e.jsxs("tr",{className:"text-nowrap ",children:[e.jsx("th",{className:"px-3 py-1",children:" Sel"}),e.jsx("th",{className:"px-3 py-1",children:" Pr"}),e.jsx("th",{className:"px-3 py-1",children:" ItmNo"}),e.jsx("th",{className:"px-3 py-1",children:" Material"}),e.jsx("th",{className:"px-3 py-1",children:" Short"}),e.jsx("th",{className:"px-3 py-1",children:" Open Qty"}),e.jsx("th",{className:"px-3 py-1",children:" Price"}),e.jsx("th",{className:"px-3 py-1",children:" Per"}),e.jsx("th",{className:"px-3 py-1",children:" Unit"}),e.jsx("th",{className:"px-3 py-1",children:" Total Value"}),e.jsx("th",{className:"px-3 py-1",children:" Curr"}),e.jsx("th",{className:"px-3 py-1",children:" Del"}),e.jsx("th",{className:"px-3 py-1",children:" MatGrp"}),e.jsx("th",{className:"px-3 py-1",children:" Buyer Grp"}),e.jsx("th",{className:"px-3 py-1",children:" Requested"})]})}),e.jsx("tbody",{className:"text-sm",children:S.length>0?S.map(l=>e.jsxs("tr",{className:"bg-white border-b",children:[e.jsx("td",{className:"px-3 py-1",children:e.jsx("input",{type:"checkbox",name:"sel",onClick:()=>ye(event,l)})}),e.jsx("td",{className:"px-3 py-1",children:l.pr_number}),e.jsx("td",{className:"px-3 py-1",children:l.item_no}),e.jsx("td",{className:"px-3 py-1",children:l.mat_code}),e.jsx("td",{className:"px-3 py-1",children:l.short_text}),e.jsx("td",{className:"px-3 py-1",children:l.qty_open}),e.jsx("td",{className:"px-3 py-1 text-right",children:z(l.price)}),e.jsx("td",{className:"px-3 py-1",children:l.per_unit}),e.jsx("td",{className:"px-3 py-1",children:l.unit}),e.jsx("td",{className:"px-3 py-1 text-right",children:z(l.total_value)}),e.jsx("td",{className:"px-3 py-1",children:l.currency}),e.jsx("td",{className:"px-3 py-1",children:l.del_date}),e.jsx("td",{className:"px-3 py-1",children:l.mat_grp}),e.jsx("td",{className:"px-3 py-1",children:l.purch_grp}),e.jsx("td",{className:"px-3 py-1",children:l.requested_by})]},l.id)):e.jsx("td",{className:"px-3 py-1 text-center",colSpan:14,children:"No Records Found"})})]})})]}),e.jsxs(fe,{className:"sm:justify-start",children:[e.jsx(H,{asChild:!0,children:e.jsx(w,{type:"button",variant:"secondary",children:"Close"})}),e.jsx(H,{asChild:!0,children:e.jsx(w,{type:"button",onClick:je,children:"Add to PO"})})]})]})]})}export{ot as default};
